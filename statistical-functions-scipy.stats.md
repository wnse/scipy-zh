# Statistical functions \(scipy.stats\)

本模块包含大量概率分布和持续增加的统计函数。

每个单变量分布就是rv\_continuous\(离散变量是rv\_discrete\)子类中的一个实例：

rv\_continuous\(\[\]\) 一般连续随机变量类，用于子类化。

rv\_discrete\(\[\]\) 一般离散随机变量类，用于子类化。

rv\_histogram\(\[\]\) 生成直方图给出的分布。

## Continuous distributions

| 函数名称 | 概要 | 描述 |
| :--- | :--- | :--- |
| alpha | alpha连续随机变量 |  |
| anglit | anglit连续随机变量 |  |
|  |  |  |

## Correlation functions

* f\_oneway
  * 单因素方差分析\(ANOVA\)
  * 使ANOVA检验的p值有效必须满足的前提：

    * 样本独立
    * 每个样本来源于正态分布总体
    * 组内的总体标准偏差相等，即同方差性

    如果这些假设对于给定的数据集不成立，那么仍然可以使用Kruskal-Wallis H检验，但会减少一些效能。
* pearsonr
  * 皮尔逊相关系数与不相关性的p值
  * 皮尔逊相关系数测量两个数据集之间的线性关系。 p值的计算依赖于每个数据集均呈正态分布的假设。像其他相关系数一样，该系数在-1和+1之间变化，其中0表示无相关。 -1或+1的相关性暗示精确的线性关系。正相关表明，随着x的增加，y也随之增加。负相关性表示随着x增加，y减小。

    p值大致表示从不相关的系统中生成的数据集中得到的Pearson相关性与从这些数据集计算得出的一样极端的概率。

  * 相关系数计算方式：

    $$
    r=\frac{\sum{(x-m_x)(y-m_y)}}{\sqrt{\sum(x-m_x)^2\sum(y-m_y)^2}}
    $$

    $m\_x$和$m\_y$分别是向量$x$和$y$的平均值。

    假设x和y是独立的正态分布（总体相关性是0），样本相关系数的概率密度函数是：

    $$
    f(r)=\frac{(1-r^2)^{(n/2-2)}}{B(1/2, n/2-1)}
    $$

    $n$是样本数量，$B$是beta函数，有时也称为r的精确分布。pearsonr中使用该分布计算p值。分布是取值\[-1, 1\]的beta分布，形状参数$a=b=n/2-1$。基于Scipy对beta分布的方式，r分布为：

    `dist = scipy.stats.beta(n/2-1, n/2-1, loc=-1, scale=2`

    pearsonr返回双尾p值。对于给定的具有相关性为r的样本，p值是来自于零相关总体的随机样本x'和y'的相关性abs\(r'\)大于或者等于abs\(r\)的概率。使用上述`dist`，给定r和长度n的p值为：

    `p = 2*dist.cdf(-abs(r))`

    当n为2时，上述连续分布的定义不明确。当形状参数a和b接近a = b = 0时，可以将beta分布的极限解释为在r=1和r=-1时具有相等概率质量的离散分布。更直接地，可以观察到，给定数据x=\[x1，x2\]和y=\[y1，y2\]，并假设x1!= x2和y1!= y2，r的唯一可能值为1和-1 。因为长度为2的任何样本x'和y'的abs\(r'\)将为1，因此长度为2的样本的两侧p值始终为1。
* spearmanr
  * 计算具有关联p值的Spearman相关系数
  * Spearman等级相关系数是两个数据集之间关系的单调性的非参度量。与Pearson相关性不同，Spearman相关性不假定两个数据集均呈正态分布。像其他相关系数一样，该系数在-1和+1之间变化，0表示无相关。 -1或+1的相关关系意味着确切的单调关系。正相关表明，随着x的增加，y也随之增加。负相关性表示随着x增加，y减小。

    p值大致表示不相关系统的数据集的Spearman相关性与从这些数据集计算得出的Spearman相关性至少一样极端的可能性。 样本量大于500左右时p值比较可靠。
* pointbiserialr
  * 点二列相关系数和p值。
  * 点二列相关用于测量二进制变量x和连续变量y之间的关系。像其他相关系数一样，该系数在-1和+1之间变化，其中0表示无相关。 -1或+1的相关性意味着确定的关系。
  * `n-1`自由度的t检验，等价于pearsonr。

    点二列相关值由公式计算：

    $$
    r_{pb}=\frac{\bar{Y_1}-\bar{Y_0}}{s_y}\sqrt{\frac{N_1N_2}{N(N-1)}}
    $$

    $Y\_0$和$Y\_1$分别是编码0和1的度量观测值的平均值；$N\_0$和$N\_1$分别是编码0和1的观测数量；$N$是观测总数，$s\_y$是所有度量观测值的标准差。

    $r_{pb}$与0的显著差异完全等价于两组间的显著差异。因此$N-2$自由度水平的独立组间t检验用来检验$r_{pb}$是否为0。两个独立组间比较t统计值与$r\_{pb}$的关系由下式给出：

    $$
    t=\sqrt{N-2}\frac{r_{pb}}{\sqrt{1-r_{pb}^2}}
    $$
* Kendalltau
  * 计算Kendall的tau值，等级相关系数的度量。
  * Kendall的tau值度量两个排序间的相似性。如果两个序列完全一致，则Kendall's tau值为1，两个毫不相关的序列的Kendall's tau值为0，而两个互逆的序列的Kendall's tau系数为-1。1945的"tau-b"版本考虑了秩，1938的“tab-a”版没有考虑秩。
  * Kendall tau定义为：

    $$
    tau = \frac{P-Q}{\sqrt{(P+Q+T)(P+Q+U)}}
    $$

    $P$是相同对的数量，$Q$是不同对的数量，$T$是只在x中秩数量，$U$是只在y中秩数量，如果秩发生在x和y同一对中，都不计入。
* weightedtau
  * 计算Kendall的加权$\tau$。
  * 加权$\tau$中高权重的交换比低权重的交换更重要。默认参数计算索引$\tau\_h$的加法双曲形式，这为重要的不重要的元素间保持了平衡。

    权重通过秩数组定义，为每个元素赋予非负秩，基于元素的秩评估权重。一个交换的权重即为交换元素秩的权重的和或积。默认参数计算$\tau\_h$：具有$r$和$s$（从0开始）的秩的元素的交换的权重$1/\(r+1\)+1/\(s+1\)$。

    只有重要性标准存在情况下，指定秩数组才有意义。如果没有特定的排序，加权$\tau$就是通过\(x, y\)和\(y, x\)字母降序排序的平均值。这是默认参数的计算方式。

    注意，如果计算秩数组的加权$\tau$，而不是得分（即，很大的值表示代的排序）必须对秩取负值，这样高秩的元素才会得到高值。

  * 

